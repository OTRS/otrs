# --
# AgentTicketOverviewPreview.dtl - provides HTML Ticket Overview
# Copyright (C) 2001-2010 OTRS AG, http://otrs.org/
# --
# $Id: AgentTicketOverviewPreview.dtl,v 1.53 2010-09-14 17:17:42 cg Exp $
# --
# This software comes with ABSOLUTELY NO WARRANTY. For details, see
# the enclosed file COPYING for license information (AGPL). If you
# did not receive this file, see http://www.gnu.org/licenses/agpl.txt.
# --
<!-- dtl:block:DocumentActionRow -->
<ul class="Actions">
<!-- dtl:block:DocumentActionRowBulk -->
    <li class="Bulk">
        <span>
            <input type="checkbox" class="AutocompleteOff" title="$Text{"Select all"}" id="SelectAllTickets" />
            <label class="InvisibleText" for="SelectAllTickets">$Text{"Select all"}</label>
        </span>
    </li>
    <li id="BulkAction" class="Bulk Inactive $QData{"CSS"}">
        <a href="#">$Text{"$Data{"Name"}"}</a>
    </li>
<!-- dtl:block:DocumentActionRowBulk -->
<!-- dtl:block:DocumentActionRowItem -->
    <li class="$QData{"CSS"}"><a href="#">$Text{"$Data{"Name"}"}</a></li>
<!-- dtl:block:DocumentActionRowItem -->
</ul>
<!-- dtl:block:DocumentActionRow -->


<!-- dtl:block:DocumentSortOrderBar -->
# nothing to show
<!-- dtl:block:DocumentSortOrderBar -->


<!-- dtl:block:DocumentHeader -->
<!-- dtl:js_on_document_complete -->
<script type="text/javascript">//<![CDATA[
    Core.UI.ActionRow.Init();
//]]></script>
<!-- dtl:js_on_document_complete -->
<ul id="TicketOverviewLarge" class="Overview OverviewLarge">
<!-- dtl:block:DocumentHeader -->


<!-- dtl:block:DocumentContent -->
    <li id="TicketID_$QData{"TicketID"}" class="MasterAction">
        <div class="Content">
<!-- dtl:block:Bulk -->
            <input class="Checkbox AutocompleteOff" type="checkbox" name="TicketID" value="$QData{"TicketID"}" />
<!-- dtl:block:Bulk -->
<!-- dtl:block:Meta -->
<!-- dtl:block:MetaIcon -->
            <div class="$QData{"Class"}" title="$Text{"$Data{"Title"}"}">
                <span class="$QData{"ClassSpan"}">$Text{"$Data{"Title"}"}</span>
            </div>
<!-- dtl:block:MetaIcon -->
<!-- dtl:block:Meta -->
            <div class="Infos">
                <h2>
                    <a href="$Env{"Baselink"}Action=AgentTicketZoom;TicketID=$LQData{"TicketID"}" title="$QData{"Title","60"}" class="MasterActionLink">$Config{"Ticket::Hook"}: $Data{"TicketNumber"} &ndash; $QData{"Title","60"}</a>
                </h2>
#               <div>
<!-- dtl:block:MenuItem -->
                <a href="$Env{"Baselink"}$Data{"Link"}" $Data{"LinkParam"} class="menuitem" title="$Text{"$Data{"Description"}"}">$Text{"$Data{"Name"}"}</a>
<!-- dtl:block:MenuItem -->
#               </div>
                <table>
                    <tbody>
                        <tr>
                            <td>
                                <label>$Text{"Age"}</label>$QData{"Age"}
                            </td>
                            <td>
                                <label>$Text{"Queue"}</label><div title="$QData{"Queue"}">$QData{"Queue","26"}</div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label>$Text{"Created"}</label>$TimeLong{"$Data{"Created"}"}
                            </td>
                            <td>
                                <label>$Text{"State"}</label><div title="$Quote{"$Text{"$Data{"State"}"}"}">$Quote{"$Text{"$Data{"State"}"}","26"}</div>
                            </td>
                        </tr>
<!-- dtl:block:Service -->
                        <tr>
                            <td>
                                <label>$Text{"Service"}</label><div title="$QData{"Service"}">$QData{"Service","26"}</div>
                            </td>
                            <td>
<!-- dtl:block:SLA -->
                                <label>$Text{"Service Level Agreement"}</label><div title="$QData{"SLA"}">$QData{"SLA","26"}</div>
<!-- dtl:block:SLA -->
                            </td>
                        </tr>
<!-- dtl:block:Service -->
                        <tr>
                            <td>
                                <label>$Text{"Owner"}</label><div title="$QData{"UserFirstname"} $QData{"UserLastname"} ($QData{"Owner"})">$QData{"UserFirstname","15"} $QData{"UserLastname","15"}</div>
                            </td>
                            <td>
                                <label>$Text{"Lock"}</label><div title="$Quote{"$Text{"$Data{"Lock"}"}"}">$Quote{"$Text{"$Data{"Lock"}"}","26"}</div>
                            </td>
                        </tr>
                        <tr class="Middle">
                            <td>
                                <label>$Text{"CustomerID"}</label><a href="$Config{"CustomerDBLink"}" class="AsPopup" $Config{"CustomerDBLinkTarget"}>$QData{"CustomerID", "26"}</a><br /><div title="$QData{"CustomerName"}">$QData{"CustomerName","15"}</div>
                            </td>
                            <td>
                                <label>$Text{"First Response Time"}</label>
<!-- dtl:block:FirstResponseTime -->
                                <div title="$Text{"Service Time"}: $QData{"FirstResponseTimeWorkingTime"}" class="$QData{"FirstResponseTimeClass"}">$QData{"FirstResponseTimeHuman"} / $TimeShort{"$QData{"FirstResponseTimeDestinationDate"}"}</div>
<!-- dtl:block:FirstResponseTime -->
                            </td>
                        </tr>
                        <tr>
                            <td>
<!-- dtl:block:Type -->
                                <label>$Text{"Type"}</label><div title="$QData{"Type"}">$QData{"Type","18"}</div>
<!-- dtl:block:Type -->
                            </td>
                            <td>
                                <label>$Text{"Update Time"}</label>
<!-- dtl:block:UpdateTime -->
                                <div title="$Text{"Service Time"}: $QData{"UpdateTimeWorkingTime"}" class="$QData{"UpdateTimeClass"}">$QData{"UpdateTimeHuman"} / $TimeShort{"$QData{"UpdateTimeDestinationDate"}"}</div>
<!-- dtl:block:UpdateTime -->
                            </td>
                        </tr>
                        <tr>
                            <td>

                            </td>
                            <td>
                                <label>$Text{"Solution Time"}</label>
<!-- dtl:block:SolutionTime -->
                                <div title="$Text{"Service Time"}: $QData{"SolutionTimeWorkingTime"}" class="$QData{"SolutionTimeClass"}">$QData{"SolutionTimeHuman"} / $TimeShort{"$QData{"SolutionTimeDestinationDate"}"}</div>
<!-- dtl:block:SolutionTime -->
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="Preview">
                <ul class="$QData{"Class"}">
<!-- dtl:block:ArticlePreview -->
                    <li class="$QData{"Class"}">
                        <h3>
                            <a href="#" title="$QData{"From"} &ndash; $QData{"Subject"} &ndash; $TimeShort{"$QData{"Created"}"}">
                                <span class="Headline">
                                    $QData{"FromRealname","50"} &ndash;
                                    <span class="Subject">$QData{"Subject","70"}</span>
                                </span>
                                <span class="DateTime">$TimeShort{"$QData{"Created"}"}</span>
                                <span class="Clear"></span>
                            </a>
                        </h3>
                        <div class="HiddenBlock">
<!-- dtl:block:ArticlePreviewActionRow -->
                            <div class="ActionRow">
                                <ul class="Actions">
<!-- dtl:block:ArticlePreviewActionRowItem -->
                                    <li class="$QData{"Class"}">
                                        <form title="$Text{"$Data{"Name"}"}" action="$Env{"CGIHandle"}" method="get" id="$QData{"FormID"}">
                                            <input type="hidden" name="Action" value="$QData{"Action"}"/>
                                            <input type="hidden" name="TicketID" value="$QData{"TicketID"}"/>
                                            <input type="hidden" name="ArticleID" value="$QData{"ArticleID"}"/>
                                            <input type="hidden" name="ReplyAll" value="$QData{"ReplyAll"}"/>
                                            <label for="ResponseID$QData{"ArticleID"}" class="InvisibleText">$Text{"$Data{"Name"}"}:</label>
                                            $Data{"StandardResponsesStrg"}
                                        </form>
<!--dtl:js_on_document_complete-->
<script type="text/javascript">//<![CDATA[
    $('#$QData{"FormID"} select[name=ResponseID]').bind('change', function (Event) {
        var URL;

        if ($(this).val() > 0) {
            var URL = Core.Config.Get('Baselink') + $(this).parents().serialize();
            Core.UI.Popup.OpenPopup(URL, 'Action');
            // reset the select box so that it can be used again from the same window
            $(this).val('0');
        }
    });
    // make sure this click event does not bubble up to the table row and execute its click handler
    $('#$QData{"FormID"} select[name=ResponseID]').bind('click', function (Event) {
        Event.stopPropagation();
        return false;
    });
//]]></script>
<!--dtl:js_on_document_complete-->
                                    </li>
<!-- dtl:block:ArticlePreviewActionRowItem -->
                                </ul>
                                <div class="ClearLeft"></div>
                            </div>
<!-- dtl:block:ArticlePreviewActionRow -->
                            <div class="Content">
$Data{"BodyNote"}
$Data{"Body"}
                            </div>
                        </div>
                    </li>
<!-- dtl:block:ArticlePreview -->
                </ul>
            </div>
            <div class="Shadow"></div>
        </div>
    </li>
<!-- dtl:block:DocumentContent -->

<!-- dtl:block:DocumentFooter -->
</ul>


<form name="bulk" action="">
    <input type="hidden" name="TicketID" value=""/>
</form>

<form action="$Env{"CGIHandle"}" method="post" enctype="multipart/form-data" name="matrix">
    <input type="hidden" name="Action" value="AgentTicketBulk"/>
<!-- dtl:block:DocumentFooterBulkItem -->
    <input type="hidden" name="TicketID" value=""/>
<!-- dtl:block:DocumentFooterBulkItem -->
    <input type="hidden" name="TicketID" value=""/>
</form>
<!-- dtl:block:DocumentFooter -->

<!-- dtl:block:DocumentMenuItem -->
<li id="$QData{"ID"}">
    <a href="#" title="$Text{"$Data{"Description"}"}">$Text{"$Data{"Name"}"}</a>
</li>
<!-- dtl:block:DocumentMenuItem -->
<!-- dtl:block:DocumentMenuItemMoveForm -->
<li class="$QData{"Class"}">
    <form title="$Text{"Move ticket to a different queue"}" action="$Env{"CGIHandle"}" method="get">
        <input type="hidden" name="Action" value="AgentTicketMove"/>
        <input type="hidden" name="QueueID" value="$QData{"QueueID"}"/>
        <input type="hidden" name="TicketID" value="$QData{"TicketID"}"/>
        <label for="DestQueueID" class="InvisibleText">$Text{"Change queue"}:</label>
        $Data{"MoveQueuesStrg"}
    </form>
<!-- dtl:js_on_document_complete -->
<script type="text/javascript">//<![CDATA[
    $('select[name=DestQueueID]').live('change', function (Event) {
        $(this).closest('form').submit();
    });
//]]></script>
<!-- dtl:js_on_document_complete -->
</li>
<!-- dtl:block:DocumentMenuItemMoveForm -->

<!-- dtl:js_on_document_complete -->
<!-- dtl:block:DocumentReadyActionRowAdd -->
<script type="text/javascript">//<![CDATA[
    Core.UI.ActionRow.AddActions($('#TicketID_$QData{"TicketID"}'), $Data{"Data"});
//]]></script>
<!-- dtl:block:DocumentReadyActionRowAdd -->
<!-- dtl:block:DocumentReadyStart -->
    <script type="text/javascript">//<![CDATA[
        Core.UI.StaticTableControl($('#OverviewControl'));
        $('.MasterAction').bind('click', function (Event) {
            window.location = $(this).find('.MasterActionLink').attr('href');
        });
        Core.UI.Accordion.Init($('.Preview > ul'), 'li h3 a', '.HiddenBlock');
    //]]></script>
<!-- dtl:block:DocumentReadyStart -->
<!-- dtl:js_on_document_complete -->

<!-- dtl:js_on_document_complete -->
$('a.AsPopup').bind('click', function (Event) {
Core.UI.Popup.OpenPopup($(this).attr('href'), 'Action');
return false;
});
<!-- dtl:js_on_document_complete -->
